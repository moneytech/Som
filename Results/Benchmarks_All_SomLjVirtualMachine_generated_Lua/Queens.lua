-- generated by SomLjVirtualMachine on Sa. Aug. 29 23:05:07 2020

local metaclass = Queens
local class = Queens._class
local function _block(f) local t = { _f = f }; setmetatable(t,Block._class); return t end
local _str = _primitives._newString
local _sym = _primitives._newSymbol
local _dbl = _primitives._newDouble
local _cl = _primitives._checkLoad

function class.benchmark(self)
	local result
	result = true;
	((1)):to_do_((10),_block( function(i)
		result = (result):and_((self):queens())
		return result
	end ));
	return result;
end

function class.verifyResult_(self,result)
	return result;
end

function class.queens(self)
	self[2] = (Array):new_withAll_((8),true);
	self[1] = (Array):new_withAll_((16),true);
	self[3] = (Array):new_withAll_((16),true);
	self[4] = (Array):new_withAll_((8),(-1));
	return (self):placeQueen_((1));
end

function class.placeQueen_(self,c)
	local _nonLocal, _nlRes
	local _status, _pcallRes = pcall( function()
		((1)):to_do_((8),_block( function(r)
						return ((self):row_column_(r,c)):ifTrue_(_block( function()
				(self[4]):at_put_(r,c);
				(self):row_column_put_(r,c,false);
				((c):_0q((8))):ifTrue_(_block( function()
					_nlRes = true; _nonLocal = true; error(_nlRes)
				end ));
				((self):placeQueen_((c):_0p((1)))):ifTrue_(_block( function()
					_nlRes = true; _nonLocal = true; error(_nlRes)
				end ));
								return (self):row_column_put_(r,c,true)
			end ))
		end ));
		return false;
	end )
	if _status then return _pcallRes elseif _nonLocal then return _nlRes else error(_pcallRes) end
end

function class.row_column_(self,r,c)
	return (((self[2]):at_(r)):_0aa((self[1]):at_((c):_0p(r)))):_0aa((self[3]):at_(((c):_0m(r)):_0p((8))));
end

function class.row_column_put_(self,r,c,v)
	(self[2]):at_put_(r,v);
	(self[1]):at_put_((c):_0p(r),v);
	(self[3]):at_put_(((c):_0m(r)):_0p((8)),v);
	return self
end

